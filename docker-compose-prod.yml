version: "3.6"
services:
    php:
        build:
            args:
                - KEY=${GITH_KEY}
        environment:
            VERSION_HASH: "${GITHUB_SHA:-none}"
        extends:
            file: docker-compose.yml
            service: php
        image: ${IMAGE}:php-latest

    nginx:
        extends:
            file: docker-compose.yml
            service: nginx
        image: ${IMAGE}:nginx-latest
        container_name: "nginx-${PROJECT_NAME}"
        ports:
            - "8080:80"
            - "4443:443"
    db:
        extends:
            file: docker-compose.yml
            service: db
        image: ${IMAGE}:db-latest

networks:
    backend-flags:
volumes:
    db-data-flags: ~
